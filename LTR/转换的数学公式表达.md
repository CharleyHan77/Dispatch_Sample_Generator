我来用数学公式的形式表达转换前后的数据样式和映射关系。

[1 tool called]

我用数学公式的形式来表达转换前后的数据样式和映射关系：

## 🧮 转换前原始数据结构 (Original Data Structure)

### 原始FJSP数据集表示

设原始标记数据集为：
\[
\mathcal{D}_{raw} = \{(I_i, P_i, F_i)\}_{i=1}^{N}
\]

其中对于第 $i$ 个FJSP实例：

**实例标识**：
\[
I_i = \text{instance\_path}_i \in \mathcal{I}
\]

**性能数据矩阵**：
\[
P_i = \begin{bmatrix}
p_{i,h} \\
p_{i,m} \\
p_{i,r}
\end{bmatrix} = \begin{bmatrix}
[\mu_{i,h}, \sigma_{i,h}, \min_{i,h}, \max_{i,h}, c_{i,h}, c\sigma_{i,h}] \\
[\mu_{i,m}, \sigma_{i,m}, \min_{i,m}, \max_{i,m}, c_{i,m}, c\sigma_{i,m}] \\
[\mu_{i,r}, \sigma_{i,r}, \min_{i,r}, \max_{i,r}, c_{i,r}, c\sigma_{i,r}]
\end{bmatrix}
\]

其中：
- $h, m, r$ 分别表示 heuristic, mixed, random 初始化方法
- $\mu, \sigma, \min, \max$ 为目标值的均值、标准差、最小值、最大值
- $c, c\sigma$ 为收敛代数的均值和标准差

**特征数据结构**：
\[
F_i = \{F_i^{basic}, F_i^{time}, F_i^{graph}, F_i^{kde}\}
\]

其中：
- $F_i^{basic} = [n_j, n_m, n_o, \bar{m}, \sigma_m]$ (问题规模域)
- $F_i^{time} = [\mu_t, \sigma_t, t_{min}, t_{max}, \sigma_{mt}]$ (时间复杂度域)  
- $F_i^{graph} = [|V|, |E|, \rho, \bar{d}, \gamma, \tau, \ldots]$ (约束结构域)
- $F_i^{kde} = [\mu_{kde}, \sigma_{kde}, \ldots, s, k, p_{pos}]$ (分布特性域)

## 🔄 数据转换映射函数 (Data Transformation Mapping)

### 主转换函数

\[
\Psi: \mathcal{D}_{raw} \rightarrow \mathcal{D}_{LTR}
\]

具体展开为三个子函数的组合：

#### 1. 特征提取函数
\[
\Phi: F_i \rightarrow \mathbf{f}_i = [f_1, f_2, \ldots, f_{44}]^T \in \mathbb{R}^{44}
\]

#### 2. 性能评估函数
\[
\Omega: P_i \times \mathbf{w} \rightarrow \mathbf{s}_i = [s_{i,h}, s_{i,m}, s_{i,r}]^T \in \mathbb{R}^3
\]

其中权重向量：
\[
\mathbf{w} = [w_q, w_s, w_e, w_c]^T, \quad \sum_{j} w_j = 1
\]

#### 3. 排名转换函数
\[
\Lambda: \mathbf{s}_i \rightarrow \mathbf{r}_i = [r_{i,h}, r_{i,m}, r_{i,r}]^T \in \{0,1,2\}^3
\]

## 📊 转换后LambdaMART格式 (Target LambdaMART Format)

### 最终输出格式

转换后的数据集表示为：
\[
\mathcal{D}_{LTR} = \{(r_{i,j}, q_i, \mathbf{f}_i, m_{i,j})\}_{i=1}^{N}, j \in \{h,m,r\}
\]

**标准LambdaMART格式**：
\[
\boxed{r_{i,j} \quad \text{qid:}q_i \quad \bigcup_{k=1}^{44} k\text{:}f_{i,k} \quad \text{\#} \quad m_{i,j}}
\]

### 格式组件说明

**相关性分数**：
\[
r_{i,j} \in \{0, 1, 2\} \quad \text{或} \quad r_{i,j} \in \mathbb{R}^+
\]

**查询标识**：
\[
q_i = i, \quad i \in \{1, 2, \ldots, N\}
\]

**特征向量**：
\[
\mathbf{f}_i = \Phi(F_i) = [f_{i,1}, f_{i,2}, \ldots, f_{i,44}]^T
\]

**元数据**：
\[
m_{i,j} = \{I_i, j, \text{meta\_info}_i\}
\]

## 🎯 完整映射关系示例

### 数学表达式

对于单个FJSP实例 $I_i$，完整的转换过程为：

\[
\begin{align}
&\text{输入}: (I_i, P_i, F_i) \\
&\text{特征提取}: \mathbf{f}_i = \Phi(F_i) \\
&\text{性能评估}: \mathbf{s}_i = \Omega(P_i, \mathbf{w}) \\
&\text{排名转换}: \mathbf{r}_i = \Lambda(\mathbf{s}_i) \\
&\text{格式化}: \forall j \in \{h,m,r\}: \\
&\quad r_{i,j} \quad \text{qid:}i \quad \text{1:}f_{i,1} \quad \text{2:}f_{i,2} \quad \cdots \quad \text{44:}f_{i,44} \quad \text{\#} \quad m_{i,j}
\end{align}
\]

### 具体实例

**原始数据片段**：
\[
\begin{align}
I_1 &= \text{"/dataset/Mk01.fjs"} \\
P_1 &= \begin{bmatrix}
[173.2, 8.1, 165, 185, 45, 12] \\
[168.5, 6.2, 160, 178, 38, 9] \\
[180.7, 12.3, 162, 195, 52, 15]
\end{bmatrix} \\
F_1^{basic} &= [10, 6, 55, 2.8, 0.9]
\end{align}
\]

**转换后输出**：
\[
\begin{align}
&2 \quad \text{qid:1} \quad \text{1:10.000000} \quad \text{2:6.000000} \quad \text{3:55.000000} \quad \cdots \quad \text{44:0.532000} \\
&\quad \text{\#} \quad \text{instance=/dataset/Mk01.fjs method=heuristic} \\
&1 \quad \text{qid:1} \quad \text{1:10.000000} \quad \text{2:6.000000} \quad \text{3:55.000000} \quad \cdots \quad \text{44:0.532000} \\
&\quad \text{\#} \quad \text{instance=/dataset/Mk01.fjs method=mixed} \\
&0 \quad \text{qid:1} \quad \text{1:10.000000} \quad \text{2:6.000000} \quad \text{3:55.000000} \quad \cdots \quad \text{44:0.532000} \\
&\quad \text{\#} \quad \text{instance=/dataset/Mk01.fjs method=random}
\end{align}
\]

## 📈 综合性能评估公式

**四维性能评估函数**：
\[
\Omega(p_{i,j}, \mathbf{w}) = w_q \cdot Q(p_{i,j}) + w_s \cdot S(p_{i,j}) + w_e \cdot E(p_{i,j}) + w_c \cdot C(p_{i,j})
\]

其中：
\[
\begin{align}
Q(p_{i,j}) &= \frac{1000}{0.5 \cdot \min_{i,j} + 0.3 \cdot \mu_{i,j} + 0.2 \cdot \max_{i,j}} \\
S(p_{i,j}) &= \frac{100}{1 + \sigma_{i,j}} \\
E(p_{i,j}) &= \frac{100}{1 + c_{i,j}} \\
C(p_{i,j}) &= \frac{50}{1 + c\sigma_{i,j}}
\end{align}
\]

这种数学表达方式清晰地展现了从原始FJSP数据到LambdaMART格式的完整转换过程，包括数据结构、映射关系和最终输出格式。